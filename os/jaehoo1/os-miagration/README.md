# OS 이관
서버 유지보수(개발 / 관리) 업무를 하다 보면 다음과 같은 이유들로 인해 서비스를 운영중인 OS를 이관해야 하는 상황이 발생한다.
- [U2L](https://github.com/jaehoo1/tmi/tree/main/U2L(Unix%20to%20Linux))
- [EOS](https://github.com/jaehoo1/tmi/tree/main/EOS(End%20of%20Support%2C%20Service)(%EC%A7%80%EC%9B%90%EC%A2%85%EB%A3%8C))
- 컨테이너화
- etc...

OS만 변경하면 간단한 작업 아닌가? 라는 생각이 들 수도 있지만, 돌아가고 있는 서비스에 따라 다음의 항목들을 꼼꼼히 체크해 보아야 한다.

## 네트워크
### 방화벽 / IP
예를 들어 기존의 OS가 백엔드 REST API 서비스를 제공중이였다면, IP가 승계되지 않을 시 변경되는 IP에 대한 방화벽 정책 여부가 기존과 동일한지 확인해야 한다.  
OS를 이관하고 기존의 어플리케이션이 사용하던 네트워크를 통해 연결되는 서비스(ex: DB, 외부 연동 서비스(결제 PG))가 사용이 불가능해지고 어플리케이션이 정상적으로 기동되지 않거나 정상 동작하지 않을 수도 있다.

### L4 / VIP / Load Balancing / Domain Name
L4 등을 통해 트래픽 로드 밸런싱을 해주고 있었다면 신규로 이관되는 OS로도 로드 밸런싱이 동일하게, 이슈없이 동작할 수 있는지 확인해야 한다. L4 하위 레벨의 로드 밸런싱은 [MW](#mwmiddle-ware)를 변경함에 따라 동작 방식이 달라질 수 있어 주의해야 한다.

## OS 설정
### 스토리지(NAS)
기존의 OS에서 동작하던 서비스가 특정 기능을 위해 로드 밸런싱 된 서버 간 NAS로 동일 폴더(경로)를 공유하고 있었다고 한다면, 신규 이관되는 서버에서도 이를 동일 시 해줘야 어플리케이션이 올바르게 동작할 수 있다.

### `/etc/hosts`
특정한 이유에서 특정 도메인에 대해 사내 DNS, 또는 ISP DNS 등 DNS를 통해 IP를 획득하지 않고 `/etc/hosts`에 직접 매핑해주는 경우가 있다. 만약 도메인에 대해 DNS를 통해 가져온 IP가 AS-IS서버의 `/etc/hosts`에 기록되어 있는 IP와 다르다면 이를 확인하고 조치해야 한다.

### 권한
어플리케이션 동작에 필요한 권한이 누락된 채로 OS를 이관한다면 서비스가 정상적으로 동작하지 않을 것이다.

## 어플리케이션 종속성
### 언어 / 프레임워크 버전
정말로 OS만 변경하고 어플리케이션을 그대로 옮겨 언어(ex: java / python / ...), 프레임워크(ex: Spring / Django / ...) 버전이 동일하게 옮겨갔다면 신경쓰지 않아도 되겠지만, 시스템 고도화가 목적이라 OS를 이관하는 김에 사용하고 있는 언어 / 프레임워크의 버전을 올렸을 수도 있다. 이 때는 버전업에 대한 동작 / 설정의 차이를 이해하고 기능 동작의 차이가 생길 수 있는 부분에 대해 검토해야 한다.

### MW(Middle Ware)
미들웨어 또한 OS를 변경하는 겸사겸사 변경될 수도 있다. 예시로, WebtoB-JEUS 구조였던 웹 어플리케이션을 Apache HTTPD/nginx-Apache Tomcat 구조로 변경할 수도 있다.  
이 때 Load Balancing의 동작 방식 등이 달라지게 되므로, 최대한 비슷하게 동작하거나 기능 상에 문제가 없게 끔 Middle Ware 설정(`httpd.conf`, `server.xml`, ...) 또한 튜닝해주어야 한다.

### 연계 서비스
이관하려는 서비스가 Jenkins를 통해 `ssh` 접속을 통해 배포가 된다고 가정하자. 그렇다면 신규 OS에 대해서도 Jenkins 파이프라인에서 접속할 수 있게끔 설정해두어야 배포를 진행할 수 있다.